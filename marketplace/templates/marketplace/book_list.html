{% extends 'base.html' %}

{% block title %}All Books{% endblock %}
{% block content %}
<!DOCTYPE html>
<html>
<head>
    <title class="text-2xl font-semibold mb-4">Student Book Market</title>
</head>
<body>
   {% if user.is_authenticated %}
        <p>Welcome, {{ user.username }} | <a href="{% url 'add_book' %}">Add Book</a> | <form method="post" action="/accounts/logout/" class="inline">
    {% csrf_token %}
    <button type="submit" class="text-red-600 hover:underline">Logout</button>
</form>
</p>
   {% else %}
        <p><a href="/accounts/login/">Login</a> | <a href="{% url 'signup' %}">Signup</a></p>
   {% endif %}
   <form method="get" class="mb-6 flex flex-wrap gap-2 items-center">
    üîç <input type="text" name="q" placeholder="Search books..." value="{{ query }}" class="px-3 py-2 border rounded w-60">
    üìù Condition:
    <select name="condition" class="px-3 py-2 border rounded">
        <option value="all">All</option>
        <option value="New" {% if condition == 'New' %}selected{% endif %}>New</option>
        <option value="Good" {% if condition == 'Good' %}selected{% endif %}>Good</option>
        <option value="Used" {% if condition == 'Used' %}selected{% endif %}>Used</option>
    </select>
    <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded">Search</button>
   </form>
   <hr>

   {% if user.is_authenticated %}
        <a href="{% url 'my_books' %}">üìö My Listings</a>
   {% endif %}
    <h1>Available Books</h1>
    <a href="{% url 'add_book' %}">Add Your Book</a>
    <hr>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    {% for book in books %}
    <div class="bg-white p-4 rounded shadow">
        <img src="{{ book.image.url }}" alt="{{ book.title }}" class="h-40 w-full object-cover rounded mb-2">
        <h3 class="font-bold text-lg">{{ book.title }}</h3>
        <p class="text-sm text-gray-500">{{ book.author }}</p>
        <p class="my-2 text-sm">{{ book.description|truncatewords:20 }}</p>
        <p class="text-sm">Condition: <strong>{{ book.condition }}</strong></p>
        <p class="text-sm text-green-600 font-semibold">‚Çπ{{ book.price }}</p>
    </div>
    {% empty %}
    <p>No books found.</p>
    {% endfor %}
</div>
{% endblock %}

</body>
</html>
